%h2 Proposals

%form{ class: 'search-form', id: 'search_form' }
  %input{ class: 'search-input', placeholder: 'Search for a film to propose', type: 'search', value: '' }

%section{ class: 'search-results', id: 'search_results' }
  %ul{ class: 'search-results-list', id: 'search_results_list' }

:javascript
  $('#search_form').on('submit', function(e) {
    e.preventDefault();

    $this = $(this);

    var query = $this.find('.search-input').val();

    var callback = function(data) {
      $list = $("#search_results_list");
      results = data['data']['results'];

      $list.html("");

      $.each(results, function(key, val) {
        year = parseInt(val['release_date']);

        $list.append("<li>" + val['title'] + " (" + year + ")</li>");
      });
    }

    var failure = function(data) {
      console.log(data);
    }

    $.ajax({
      contentType: 'application/json',
      type: 'GET',
      url: '/search',
      data: { query: query },
      dataType: 'json',
      success: callback,
      error: failure
    })
  });
